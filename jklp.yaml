points:
  zones:
    matrix:
      columns:
        pinky:
          rows:
            bottom:
              bind: [0, 4, 0, 0]
              shift: [-19, 24]
            top:
              bind: [0, 4, 4, 0]
          key:
            column_net: P4
            column_mark: P
        ring:
          stagger: 22
          rows:
            top:
              bind: [0, 4, 4, 0]
            home:
              bind: [0, 4, 4, 0]
            bottom:
              bind: [0, 0, 0, 4]
          key:
            column_net: P5
            column_mark: R
        middle:
          stagger: 7
          rows:
            top:
              bind: [0, 0, 4, 0]
            home:
              bind: [0, 0, 4, 0]
            bottom:
              bind: [0, 4, 0, 4]
          key:
            column_net: P7
            column_mark: M
        index:
          stagger: -7
          rows:
            top:
              bind: [0, 0, 4, 4]
            home:
              bind: [0, 0, 4, 4]
          key:
            column_net: P8
            column_mark: X
        inner:
          rows:
            top:
              bind: [0, 0, 4, 4]
            home:
              bind: [0, 0, 4, 4]
            bottom:
              bind: [0, 0, 0, 4]
          key:
            column_net: P1
            column_mark: I
      rows:
        bottom:
          row_net: P16
          row_mark: LB
          mirror:
            row_net: P9
            row_mark: RB
        home:
          row_net: P15
          row_mark: LH
          mirror:
            row_net: P6
            row_mark: RH
        top:
          row_net: P20
          row_mark: LT
          mirror:
            row_net: P2
            row_mark: RT
    switch_footprints:
      extends: matrix
      key:
        footprints: &quad
          mx:
            type: mx
            nets:
              from: '!colrow'
              to: '!column_net'
          alps:
            type: alps
            nets:
              from: '!colrow'
              to: '!column_net'
          diode:
            type: diode
            anchor:
              rotate: 90
              shift: [8.25, 0]
            nets:
              from: '!colrow'
              to: '!row_net'
        mirror:
          footprints: &quad_mirror
            mx:
              nets:
                from: '!column_net'
                to: '!colrow'
            alps:
              nets:
                from: '!column_net'
                to: '!colrow'
    thumbfan:
      anchor:
        ref: matrix_inner_bottom
        shift: [0, -19]
      columns:
        near:
          rows:
            thumb:
              bind: [4, 0, 0, 0]
              column_net: P7
        home:
          rows:
            thumb:
              column_net: P8
        far:
          rows:
            thumb:
              bind: [4, 0, 0, 0]
              shift: [-5, -19]
              column_net: P1
      rows:
        thumb:
          row_net: P10
          row_mark: LF
      key:
        footprints: *quad
        mirror: *quad_mirror
  rotate: -25
  mirror:
    ref: matrix_inner_top
    distance: 30
outlines:
  glue:
    default:
      top:
        left:
          ref: matrix_inner_top
          shift: [0.5, 0.5]
        right:
          ref: mirror_matrix_inner_top
          shift: [0.5, 0.5]
      bottom:
        left:
          ref: thumbfan_near_thumb
          shift: [0.5, -0.5]
        right:
          ref: mirror_thumbfan_near_thumb
          shift: [0.5, -0.5]
  exports:
    _pcb_edge:
      - type: keys
        side: both
        size: [15.6, 15.6] # MX switch dimensions
    mockup:
      - operation: add
        type: outline
        name: _pcb_edge
      - operation: stack
        type: keys
        side: both
        size: [15.6, 15.6] # MX switch dimensions
        bound: false
pcbs:
  main:
    outlines:
      main:
        outline: _pcb_edge
    footprints:
      mcu:
        type: promicro
        anchor:
          ref:
            - matrix_inner_bottom
            - mirror_matrix_inner_bottom
          rotate: 270
          shift: [0, -2]
